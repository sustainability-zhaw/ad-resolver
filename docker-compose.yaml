version: "3.8"
services:
  app:
    build:
      context: ./app
    restart: 'no'
    env_file:
      - ./.env
    command: tail -f /dev/null
    volumes:
      - ./app/src:/app

  db:
    hostname: dgraph_standalone # Hardcoded in db_init entrypoint.sh
    image: dgraph/standalone:v22.0.1
    restart: 'no'
    ports:
      - '8080:8080'
      - '9080:9080'

  db_init:
    image: ghcr.io/sustainability-zhaw/dgraph-schema:sha-d2daeec
    restart: 'no'
    volumes:
      - ./schema:/data/schema
    profiles:
      - tools

  db_browser:
    image: dgraph/ratel:v21.12.0
    restart: 'no'
    ports:
      - '8000:8000'
